<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
  <meta http-equiv="Content-Security-Policy"
    content="style-src 'self'; script-src 'self' 'unsafe-inline'; manifest-src 'self'; img-src 'self' data:; font-src 'self' data:;" />
  <title>Login |CodeC</title>
  <link rel="icon" href="{{CS_STATIC_BASE}}/src/browser/media/favicon-dark-support.svg" />
  <link rel="alternate icon" href="{{CS_STATIC_BASE}}/src/browser/media/favicon.ico" />
  <link rel="manifest" href="{{BASE}}/manifest.json" crossorigin="use-credentials" />
  <link rel="apple-touch-icon" sizes="192x192" href="{{CS_STATIC_BASE}}/src/browser/media/pwa-icon-192.png" />
  <link rel="apple-touch-icon" sizes="512x512" href="{{CS_STATIC_BASE}}/src/browser/media/pwa-icon-512.png" />
  <link href="{{CS_STATIC_BASE}}/src/browser/pages/global.css" rel="stylesheet" />
  <link href="{{CS_STATIC_BASE}}/src/browser/pages/login.css" rel="stylesheet" />
  <meta id="coder-options" data-settings="{{OPTIONS}}" />
</head>

<body>
  <div class="wrapper">
    <div class="info-box">
      Made with
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 11">
        <path shape-rendering="crispEdges" fill="#00000000" d="M0 0h1v1H0zM1 0h1v1H1z" />
        <path shape-rendering="crispEdges" d="M2 0h1v1H2zM3 0h1v1H3zM4 0h1v1H4z" />
        <path shape-rendering="crispEdges" fill="#00000000" d="M5 0h1v1H5z" />
        <path shape-rendering="crispEdges" d="M6 0h1v1H6zM7 0h1v1H7zM8 0h1v1H8z" />
        <path shape-rendering="crispEdges" fill="#00000000" d="M9 0h1v1H9zM10 0h1v1h-1zM0 1h1v1H0z" />
        <path shape-rendering="crispEdges" d="M1 1h1v1H1z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M2 1h1v1H2zM3 1h1v1H3zM4 1h1v1H4z" />
        <path shape-rendering="crispEdges" d="M5 1h1v1H5z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M6 1h1v1H6zM7 1h1v1H7zM8 1h1v1H8z" />
        <path shape-rendering="crispEdges" d="M9 1h1v1H9z" />
        <path shape-rendering="crispEdges" fill="#00000000" d="M10 1h1v1h-1z" />
        <path shape-rendering="crispEdges" d="M0 2h1v1H0z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M1 2h1v1H1zM2 2h1v1H2zM3 2h1v1H3zM4 2h1v1H4zM5 2h1v1H5zM6 2h1v1H6z" />
        <path shape-rendering="crispEdges" fill="#fff" d="M7 2h1v1H7z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M8 2h1v1H8zM9 2h1v1H9z" />
        <path shape-rendering="crispEdges" d="M10 2h1v1h-1zM0 3h1v1H0z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M1 3h1v1H1zM2 3h1v1H2zM3 3h1v1H3zM4 3h1v1H4zM5 3h1v1H5zM6 3h1v1H6zM7 3h1v1H7z" />
        <path shape-rendering="crispEdges" fill="#fff" d="M8 3h1v1H8z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M9 3h1v1H9z" />
        <path shape-rendering="crispEdges" d="M10 3h1v1h-1zM0 4h1v1H0z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M1 4h1v1H1zM2 4h1v1H2zM3 4h1v1H3zM4 4h1v1H4zM5 4h1v1H5zM6 4h1v1H6zM7 4h1v1H7zM8 4h1v1H8zM9 4h1v1H9z" />
        <path shape-rendering="crispEdges" d="M10 4h1v1h-1zM0 5h1v1H0z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M1 5h1v1H1zM2 5h1v1H2zM3 5h1v1H3zM4 5h1v1H4zM5 5h1v1H5zM6 5h1v1H6zM7 5h1v1H7zM8 5h1v1H8zM9 5h1v1H9z" />
        <path shape-rendering="crispEdges" d="M10 5h1v1h-1z" />
        <path shape-rendering="crispEdges" fill="#00000000" d="M0 6h1v1H0z" />
        <path shape-rendering="crispEdges" d="M1 6h1v1H1z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M2 6h1v1H2zM3 6h1v1H3zM4 6h1v1H4zM5 6h1v1H5zM6 6h1v1H6zM7 6h1v1H7zM8 6h1v1H8z" />
        <path shape-rendering="crispEdges" d="M9 6h1v1H9z" />
        <path shape-rendering="crispEdges" fill="#00000000" d="M10 6h1v1h-1zM0 7h1v1H0zM1 7h1v1H1z" />
        <path shape-rendering="crispEdges" d="M2 7h1v1H2z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M3 7h1v1H3zM4 7h1v1H4zM5 7h1v1H5zM6 7h1v1H6zM7 7h1v1H7z" />
        <path shape-rendering="crispEdges" d="M8 7h1v1H8z" />
        <path shape-rendering="crispEdges" fill="#00000000" d="M9 7h1v1H9zM10 7h1v1h-1zM0 8h1v1H0zM1 8h1v1H1zM2 8h1v1H2z" />
        <path shape-rendering="crispEdges" d="M3 8h1v1H3z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M4 8h1v1H4zM5 8h1v1H5zM6 8h1v1H6z" />
        <path shape-rendering="crispEdges" d="M7 8h1v1H7z" />
        <path shape-rendering="crispEdges" fill="#00000000" d="M8 8h1v1H8zM9 8h1v1H9zM10 8h1v1h-1zM0 9h1v1H0zM1 9h1v1H1zM2 9h1v1H2zM3 9h1v1H3z" />
        <path shape-rendering="crispEdges" d="M4 9h1v1H4z" />
        <path shape-rendering="crispEdges" fill="#ed1c24" d="M5 9h1v1H5z" />
        <path shape-rendering="crispEdges" d="M6 9h1v1H6z" />
        <path shape-rendering="crispEdges" fill="#00000000" d="M7 9h1v1H7zM8 9h1v1H8zM9 9h1v1H9zM10 9h1v1h-1zM0 10h1v1H0zM1 10h1v1H1zM2 10h1v1H2zM3 10h1v1H3zM4 10h1v1H4z" />
        <path shape-rendering="crispEdges" d="M5 10h1v1H5z" />
        <path shape-rendering="crispEdges" fill="#00000000" d="M6 10h1v1H6zM7 10h1v1H7zM8 10h1v1H8zM9 10h1v1H9zM10 10h1v1h-1z" />
      </svg>
      <br>
      by <a href="https://github.com/majo418" target="_blank" rel="noopener noreferrer">Majo418</a><br>
      based on <a href="https://github.com/coder/code-server" target="_blank"
        rel="noopener noreferrer">code-server</a><br>
      & <a href="https://hub.docker.com/_/ubuntu/" target="_blank"
      rel="noopener noreferrer">Ubuntu (Docker)</a><br>
      powered by <a href="https://github.com/CoreUnit-NET" target="_blank" rel="noopener noreferrer">CoreUnitNET</a>
    </div>

    <div class="login-box">
      <svg version="1.2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2560 1020" width="100%">
        <path fill="#a72a2aed"
          d="m1282.3 565v132.3l8.4 9.3-8.4 8.2v-1.2l-291.1 290.2 13.1-67.9v-816.6l-18.7-29.2h233l63.7 47.9v118.2h-112.3v-28.1h-62.7v448.1l62.7-57.3v-53.9zm73-474.9h202.1l42.1 52.6v534.7l-154.4 141.5-130.1-129.8v-542.9zm130.1 139.2h-62.7v365.1l62.7 66.6zm132.9-139.2h243.3l42.1 52.7v417.6l-284.5 245.7zm171.3 139.2h-62.7v330l62.7-50.3zm302.3 257.4h-60.9v107.6l62.7 66.7v-129.9h114.2v146.3l-154.4 141.5-130.1-129.8v-542.9l40.3-56.2h202.1l42.1 52.7v163.8h-114.2v-77.2h-62.7v114.6h60.9zm414.6 78.4v132.2l8.4 9.4-8.4 8.2v-1.2l-291.1 290.1 13.1-67.8v-816.6l-18.7-29.3h233l63.7 48v118.1h-112.3v-28h-62.8v448l62.8-57.3v-53.8z" />
        <path fill="#ff641c"
          d="m965 454v103.7h-20.3c-69.6 0-69.6 13-69.6 61.1v227.8c0 115.5-60.4 162.6-208.5 162.6h-354.1c-148.2 0-208.6-47.1-208.6-162.6v-227.8c0-48.1 0-61.1-69.6-61.1h-20.3v-103.7h20.3c64.7 0 68.5-6.8 68.5-59.9v-220.5c0-116.2 60.8-163.6 209.7-163.6h20.3v111.2h-20.3c-67.5 0-70.7 12.1-70.7 50.3v206.5c0 60-15.2 102.7-46.3 129.3 39.4 33 45.2 83.6 45.2 126.4v215.1c0 36.6 3.5 49.2 71.8 49.2h354.1c68.2 0 71.7-12.6 71.7-49.2v-215.1c0-42.8 5.8-93.4 45.2-126.4-31-26.6-46.3-69.3-46.3-129.3v-206.5c0-38.2-3.2-50.3-70.6-50.3h-20.3v-111.2h20.3c148.9 0 209.6 47.4 209.6 163.6v220.5c0 53.1 3.8 59.9 68.5 59.9z" />
      </svg>

      <div class="header">
        <h3 class="main withUsername">Welcome <b>{{USERNAME}}</b>,</h3>
        <div class="sub">please enter your developer password:</div>
      </div>

      <div class="error-box">
        {{ERROR}}
      </div>

      <form method="post" id="codec-from">
        <div class="user-box">
          <input class="user" type="text" autocomplete="username" />
          <input id="base" type="hidden" name="base" value="{{BASE}}" />
          <input id="href" type="hidden" name="href" value="" />

          <input required autofocus class="password" type="password" name="password" autocomplete="current-password"
            onkeydown="passKey(event)" />
          <label>Password</label>
        </div>
        <a id="submit-button" href="#" onclick="document.getElementById('codec-from').submit()">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          Let's code!
        </a>
      </form>
    </div>

  </div>
  <script>
    const mouseevent = {
      'view': window,
      'bubbles': true,
      'cancelable': true,
    }

    function hoverOver(element) {
      typeof element.onmouseover == "function" && element.onmouseover()
      typeof element.mouseover == "function" && element.mouseover()
      typeof element.focus == "function" && element.focus()

      element.dispatchEvent(new MouseEvent('mouseover', mouseevent))
    }

    function hoverLeave(element) {
      element.dispatchEvent(new MouseEvent('mouseout', mouseevent))
      element.dispatchEvent(new MouseEvent('mouseleave', mouseevent))

      typeof element.focus == "function" && element.blur()
      typeof element.onmouseout == "function" && element.onmouseout()
      typeof element.mouseout == "function" && element.mouseout()
      typeof element.onmouseleave == "function" && element.onmouseleave()
      typeof element.mouseleave == "function" && element.mouseleave()
    }

    function getUser() {
      let user = new URL(window.location).hostname
      while (
        user.startsWith("/") ||
        user.startsWith(".") ||
        user.startsWith(":")
      ) {
        user = user.substring(1)
      }
      while (
        user.endsWith("/") ||
        user.endsWith(".") ||
        user.endsWith(":")
      ) {
        user = user.slice(0, -1)
      }
      return user.split(".")[0].split(":")[0]
    }

    document.addEventListener("DOMContentLoaded", () => {
      const user = getUser()

      document.title = "" + user + " |CodeC"
      for (const element of document.getElementsByClassName("withUsername")) {
        element.innerHTML = element.innerHTML.split("{{USERNAME}}").join(user)
      }
    })

    const timoutPromise = (millis) => new Promise(
      (res) => setTimeout(
        () => res(),
        millis
      )
    )

    let running = false
    async function passKey(event) {
      // 13 = [ENTER]
      if (running || event.keyCode !== 13) {
        return
      }
      const form = document.getElementById('codec-from')
      const submit = document.getElementById('submit-button')
      running = true
      form.disabled = true
      await timoutPromise(300)
      hoverOver(submit)
      await timoutPromise(300)
      hoverLeave(submit)
      await timoutPromise(300)
      form.submit()
      await timoutPromise(300)
      form.disabled = false
      running = false
    }

    const el = document.getElementById("href")
    if (el) {
      el.value = location.href
    }
  </script>
</body>

</html>